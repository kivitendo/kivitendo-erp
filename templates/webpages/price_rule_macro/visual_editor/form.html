[%- USE T8 %]
[%- USE HTML %]
[%- USE LxERP %]
[%- USE P %]
[%- USE L %]

<h1>[% 'Price Rules Macro' | $T8 %]</h1>

[% PROCESS 'common/flash.html' %]
[% PROCESS 'price_rule_macro/visual_editor/input_blocks.html' %]

<style>
  #price_rule_action_container {
    overflow-x: scroll
  }
  #price_rule_macro fieldset {
    font-weight: normal;
  }
  #price_rule_macro fieldset legend {
    font-weight: bold;
    white-space: nowrap;
  }
  .nowrap {
    white-space: nowrap;
  }
  #price_rule_macro div > div.price_rule_element:first-of-type > fieldset > legend > span.price_rule_macro_remove_line {
    display:none;
  }
  #price_rule_macro .price_rule_horizontal_block {
    display: flex;
    flex-direction: row;
    align-items: stretch;
  }
  #price_rule_macro .price_rule_horizontal_block div {
    flex-grow: 1;
  }
  #price_rule_macro .price_rule_vertical_block {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
  #price_rule_macro .price_rule_vertical_block div {
    flex-grow: 1;
  }
  #price_rule_macro .price_rule_element {
    display: flex;
  }
  #price_rule_macro .price_rule_macro_add_empty_block {
    text-align: center;
    padding-left: 3px;
    padding-right: 3px;
  }
  #price_rule_macro .price_rule_macro_add_empty_block:hover {
    background-color: grey;
  }
</style>

<form id='#form' action='controller.pl' method='post'>
  <div id='price_rule_macro'>
    <table>
      <tr>
        <td>[% 'Name' | $T8 %]</td>
        <td>[% L.input_tag('price_rule_macro.name', SELF.price_rule_macro.name) %]
      </tr>
      <tr>
        <td>[% 'Valid for' | $T8 %]</td>
        <td>[% L.select_tag('price_rule_macro.type', [[ 'customer', LxERP.t8('Sales') ],[ 'vendor', LxERP.t8('Purchase')] ]  default=SELF.price_rule_macro.type) %]</td>
      </tr>

      <tr>
        <td>[% 'Priority' | $T8 %]</td>
        <td>[% L.select_tag('price_rule_macro.priority', [ [ '', LxERP.t8('All') ], [ 3, LxERP.t8('Normal') ], [ 4 , LxERP.t8('Override')]], default=SELF.price_rule_macro.priority) %]</td>
      </tr>

      <tr>
        <td>[% 'Obsolete' | $T8 %]</td>
        <td>[% L.checkbox_tag('price_rule_macro.obsolete', checked=SELF.price_rule_macro.obsolete, for_submit=1) %]</td>
      </tr>

      <tr>
       <th align="right">[% 'Notes' | $T8 %]</th>
       <td>[% L.textarea_tag('price_rule_macro.notes', SELF.price_rule_macro.notes, style='width: 300px') %]</td>
      </tr>
    </table>

    <div id='price_rule_action_container'>
    [% PROCESS action_input item=SELF.price_rule_macro.parsed_definition.action prefix='price_rule_macro.action' %]
    </div>
    [% L.hidden_tag('price_rule_macro.id', SELF.price_rule_macro.id) %]
  </div>
</form>

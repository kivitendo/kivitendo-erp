[%- USE T8 %]
[% USE HTML %]<body class="admin">

 <script type="text/javascript" src="js/common.js"></script>
 <script type="text/javascript" src="js/jquery.js"></script>
 <script type="text/javascript">
  <!--
      function open_connection_test_window() {
        // host name port user passwd
        var url = "admin.pl?INPUT_ENCODING=UTF-8&action=test_db_connection&" +
          "dbhost="   + encodeURIComponent(get_input_value("dbhost"))   + "&" +
          "dbport="   + encodeURIComponent(get_input_value("dbport"))   + "&" +
          "dbname="   + encodeURIComponent(get_input_value("dbname"))   + "&" +
          "dbuser="   + encodeURIComponent(get_input_value("dbuser"))   + "&" +
          "dbpasswd=" + encodeURIComponent(get_input_value("dbpasswd")) + "&";

        var parm = centerParms(400,300) + ",width=400,height=300,status=yes,scrollbars=yes";

        window.open(url, "_new_generic", parm);
      }
    -->
 </script>

 <form name="Form" id="Form" method="post" action="admin.pl">

  <div class="listtop" width="100%">[% title %]</div>

  <table width="100%">
   <tr valign="top">
    <td>
     <table>
      <tr>
       <th align="right">[% 'Login' | $T8 %]</th>
       <td>
        [%- IF edit %]
         <input type="hidden" name="login" value="[% HTML.escape(myc_login) %]">[% HTML.escape(myc_login) %]
        [%- ELSE %]
         <input name="login" value="[% HTML.escape(myc_login) %]">
        [%- END %]
       </td>
      </tr>

      <tr>
       <th align="right">[% 'Password' | $T8 %]</th>
       <td>[% IF CAN_CHANGE_PASSWORD %]<input type="password" name="new_password" size="8" value="********">[% ELSE %]********[% END %]</td>
      </tr>

      <tr>
       <th align="right">[% 'Name' | $T8 %]</th>
       <td><input name="name" size="15" value="[% HTML.escape(myc_name) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'E-mail' | $T8 %]</th>
       <td><input name="email" size="30" value="[% HTML.escape(myc_email) %]"></td>
      </tr>

      <tr valign="top">
       <th align="right">[% 'Signature' | $T8 %]</th>
       <td><textarea name="signature" rows="3" cols="35">[% HTML.escape(myc_signature) %]</textarea></td>
      </tr>

      <tr>
       <th align="right">[% 'Phone' | $T8 %]</th>
       <td><input name="tel" size="14" value="[% HTML.escape(myc_tel) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'Fax' | $T8 %]</th>
       <td><input name="fax" size="14" value="[% HTML.escape(myc_fax) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'Company' | $T8 %]</th>
       <td><input name="company" size="35" value="[% HTML.escape(myc_company) %]"></td>
      </tr>

      <tr valign="top">
       <th align="right">[% 'Address' | $T8 %]</th>
       <td><textarea name="address" rows="4" cols="35">[% HTML.escape(myc_address) %]</textarea></td>
      </tr>

      <tr valign="top">
       <th align="right">[% 'Tax number' | $T8 %]</th>
       <td><input name="taxnumber" size="14" value="[% HTML.escape(myc_taxnumber) %]"></td>
      </tr>

      <tr valign="top">
       <th align="right">[% 'Ust-IDNr' | $T8 %]</th>
       <td><input name="co_ustid" size="14" value="[% HTML.escape(myc_co_ustid) %]"></td>
      </tr>

      <tr valign="top">
       <th align="right">[% 'DUNS-Nr' | $T8 %]</th>
       <td><input name="duns" size="14" value="[% HTML.escape(myc_duns) %]"></td>
      </tr>
     </table>
    </td>

    <td>
     <table>
      <tr>
       <th align="right">[% 'Date Format' | $T8 %]</th>
       <td>
        <select name="dateformat">
         [% FOREACH row = ALL_DATEFORMATS %]<option [% IF row.selected %]selected[% END %]>[% HTML.escape(row.format) %]</option>
         [% END %]
        </select>
       </td>
      </tr>

      <tr>
       <th align="right">[% 'Number Format' | $T8 %]</th>
       <td>
        <select name="numberformat">
         [% FOREACH row = ALL_NUMBERFORMATS %]<option [% IF row.selected %]selected[% END %]>[% HTML.escape(row.format) %]</option>
         [% END %]
        </select>
       </td>
      </tr>

      <tr>
       <th align="right">[% 'Dropdown Limit' | $T8 %]</th>
       <td><input name="vclimit" value="[% HTML.escape(myc_vclimit) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'Language' | $T8 %]</th>
       <td>
        <select name="countrycode">
         [% FOREACH row = ALL_COUNTRYCODES %]<option value="[% HTML.escape(row.value) %]" [% IF row.selected %]selected[% END %]>[% HTML.escape(row.name) %]</option>
         [% END %]
        </select>
       </td>
      </tr>

      <tr>
       <th align="right">[% 'Stylesheet' | $T8 %]</th>
       <td>
        <select name="userstylesheet">
         [% FOREACH row = ALL_STYLESHEETS %]<option [% IF row.selected %]selected[% END %]>[% HTML.escape(row.name) %]</option>
         [% END %]
        </select>
       </td>
      </tr>

      <tr>
       <th align="right">[% 'Printer' | $T8 %]</th>
       <td><input name="printer" size="20" value="[% HTML.escape(myc_printer) %]"></td>
      </tr>
      <tr>
       <th align="right">[% 'Use Templates' | $T8 %]</th>
       <td>
        <select name="usetemplates">
         [% FOREACH row = ALL_TEMPLATES %]<option [% IF row.selected %]selected[% END %]>[% HTML.escape(row.name) %]</option>
         [% END %]
        </select>
       </td>
      </tr>
      <tr>
       <th align="right">[% 'New Templates' | $T8 %]</th>
       <td><input name="newtemplates"></td>
      </tr>
      <tr>
       <th align="right">[% 'Setup Templates' | $T8 %]</th>
       <td>
        <select name="mastertemplates">
         [% FOREACH row = ALL_MASTER_TEMPLATES %]<option [% IF row.selected %]selected[% END %]>[% HTML.escape(row.name) %]</option>
         [% END %]
        </select>
       </td>
      </tr>
      <tr>
       <th align="right">[% 'Setup Menu' | $T8 %]</th>
       <td>
        <select name="menustyle">
         <option value="v3"[% IF menustyle_v3 %] selected[% END %]>[% 'Top (CSS)' | $T8 %]</option>
         <option value="v4"[% IF menustyle_v4 %] selected[% END %]>[% 'Top (CSS) new' | $T8 %]</option>
         <option value="neu"[% IF menustyle_neu %] selected[% END %]>[% 'Top (Javascript)' | $T8 %]</option>
         <option value="xml"[% IF menustyle_xml %] selected[% END %]>[% 'Top (XUL; only for Mozilla Firefox)' | $T8 %]</option>
         <option value="old"[% IF menustyle_old %] selected[% END %]>[% 'Old (on the side)' | $T8 %]</option>
        </select>
       </td>
      </tr>

      <input type="hidden" name="templates" value="[% HTML.escape(myc_templates) %]">
     </table>
    </td>
   </tr>

   <tr class="listheading">
    <th colspan="2">[% 'Database' | $T8 %]</th>
   </tr>

   <tr>
    <td colspan="2">
     <table>
      <tr>
       <th align="right">[% 'Driver' | $T8 %]</th>
       <td>PostgreSQL</td>
       <th align="right">[% 'Host' | $T8 %]</th>
       <td><input name="dbhost" size="30" value="[% HTML.escape(myc_dbhost) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'Dataset' | $T8 %]</th>
       <td><input name="dbname" size="15" value="[% HTML.escape(myc_dbname) %]"></td>
       <th align="right">[% 'Port' | $T8 %]</th>
       <td><input name="dbport" size="4" value="[% HTML.escape(myc_dbport) %]"></td>
      </tr>

      <tr>
       <th align="right">[% 'User' | $T8 %]</th>
       <td><input name="dbuser" size="15" value="[% HTML.escape(myc_dbuser) %]"></td>
       <th align="right">[% 'Password' | $T8 %]</th>
       <td><input name="dbpasswd" type="password" size="10" value="[% HTML.escape(myc_dbpasswd) %]"></td>
      </tr>

      <tr>
       <td colspan="2"><input type="button" class="submit" onclick="open_connection_test_window();" value="[% 'Test connection' | $T8 %]"></td>
      </tr>
     </table>
    </td>
   </tr>

   [% IF edit %]
   <tr><td colspan="2"><hr size="3" noshade></td></tr>

   <tr class="listheading">
    <th colspan="2">[% 'Group membership' | $T8 %]</th>
   </tr>

   <tr>
    <td colspan="2">[% 'The user is a member in the following group(s):' | $T8 %]</td>
   </tr>

   <tr>
    <td colspan="2">[% FOREACH row = GROUPS %]<a href="admin.pl?action=edit_group&group_id=[% HTML.url(row.id) %]">[% HTML.escape(row.name) %]</a>
     [% UNLESS loop.last %] | [% END %][% END %]</td>
   </tr>
   [% END %]

   <tr><td colspan="2"><hr size="3" noshade></td></tr>

  </table>

  <input name="callback" type="hidden" value="admin.pl?action=list_users">

  <input type="hidden" name="action" value="dispatcher">
  <input type="submit" class="submit" name="action_save_user" value="[% 'Save' | $T8 %]">

  [% IF edit %]
   [% FOREACH row = GROUPS %]
    <input type="hidden" name="new_user_group_ids[]" value="[% HTML.escape(row.id) %]">
   [% END %]
   <input type="hidden" name="new_user_login" id="new_user_login" value="">
   <input type="hidden" name="action_save_user_as_new" id="action_save_user_as_new" value="">
   <input type="button" class="submit" id="save_as_new_button" value="[% 'Save as new' | $T8 %]">
   <input type="submit" class="submit" name="action_delete_user" value="[% 'Delete' | $T8 %]">
   <input type="hidden" name="edit" value="1">
  [% END %]

 </form>

 <script type="text/javascript">
  <!--
    $(document).ready(function() {
      $("#save_as_new_button").click(function() {
        var new_user_login = prompt('[% 'Please enter the login for the new user.' | $T8 %]', '');
        if (!new_user_login || (new_user_login == ''))
          return;

        $("#action_save_user_as_new").attr('value', '1');
        $("#new_user_login").attr('value', new_user_login);
        $("#Form").submit();
      });
    });
    -->
 </script>

</body>
</html>
